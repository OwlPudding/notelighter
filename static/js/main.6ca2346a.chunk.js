(this["webpackJsonprehearsal-tool"]=this["webpackJsonprehearsal-tool"]||[]).push([[0],{126:function(e,t,a){e.exports=a(236)},132:function(e,t,a){},133:function(e,t,a){},139:function(e,t){},141:function(e,t){},142:function(e,t){},143:function(e,t){},144:function(e,t){},236:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),r=a(27),c=a.n(r),o=(a(131),a(132),a(62)),l=a(55),i=a(56),u=a(28),m=a(60),p=a(59),d=(a(133),a(124)),f=a(85),h=a(238),g=a(81),y=a.n(g),v=a(110),b=a(82),E=function(e){Object(m.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).initDraw=function(e){var t=Object(u.a)(n),a=document.querySelector("#canvas").getBoundingClientRect(),r=t.state.selections[t.state.pageNumber].length,c={x:0,y:0,startX:0,startY:0},o=null;e.onmousemove=function(e){!function(e){var t=e||window.event;t.pageX?(c.x=t.pageX-a.x,c.y=t.pageY-a.y):t.clientX&&(c.x=t.clientX-a.x,c.y=t.clientY-a.y)}(e),null!==o&&0===o.children.length&&(o.style.width=Math.abs(c.x-c.startX)+"px",o.style.height=Math.abs(c.y-c.startY)+"px",o.style.left=c.x-c.startX<0?c.x+"px":c.startX+"px",o.style.top=c.y-c.startY<0?c.y+"px":c.startY+"px")},e.onclick=function(a){if(r=t.state.selections[t.state.pageNumber].length,"measure-count"===a.target.className);else if(null!==o){var n=document.createElement("input");n.type="number",n.className="measure-count";var l=o;o.appendChild(n),n.focus(),n.onblur=function(a){if(""===this.value)e.removeChild(l);else{var n=s.a.createElement("div",{className:"rectangle",style:{backgroundColor:o.style.backgroundColor,width:o.style.width,height:o.style.height,left:o.style.left,top:o.style.top},id:r,key:"".concat(r++,"_").concat(this.value)},s.a.createElement("h1",null,this.value)),c=t.state.selections;c[t.state.pageNumber].push(n),t.setState({selections:c}),e.removeChild(l)}o=null},n.addEventListener("keyup",(function(e){13===e.keyCode&&this.blur()})),e.style.cursor="default"}else c.startX=c.x,c.startY=c.y,(o=document.createElement("div")).className="rectangle",o.setAttribute("id",r++),o.style.left=c.x+"px",o.style.top=c.y+"px",o.style.backgroundColor=t.state.selected.color,e.appendChild(o),e.style.cursor="crosshair"},e.oncontextmenu=function(e){if("rectangle"===e.target.className){var a=t.state.selections;a[t.state.pageNumber].splice(e.target.id,1),t.setState({selections:a})}else"measure-count"===e.target.className&&e.target.blur();return!1}},n.prevPage=function(){n.setState({pageNumber:n.state.pageNumber-1<=1?1:n.state.pageNumber-1})},n.nextPage=function(){n.setState({pageNumber:n.state.pageNumber+1>=n.state.numPages?n.state.numPages:n.state.pageNumber+1})},n.controls=[{name:"Measure",color:"#65F2D55E"},{name:"Rest",color:"#EF626C5E"},{name:"Repeat",color:"#FFE8A25E"},{name:"Other",color:"#76C3D55E"}],n.state={numPages:null,pageNumber:1,selected:n.controls[0],selections:null,timestamps:[]},n.onDocumentLoadSuccess=n.onDocumentLoadSuccess.bind(Object(u.a)(n)),n}return Object(i.a)(a,[{key:"onDocumentLoadSuccess",value:function(){var e=Object(v.a)(y.a.mark((function e(t){var a,n,s;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(a=t._pdfInfo.numPages,n={},s=0;s<a;s++)n[s+1]=[];return e.next=5,this.setState({numPages:a,selections:n});case 5:this.initDraw(document.getElementById("canvas"));case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"doc-viewer"},s.a.createElement("div",{className:"controls"},s.a.createElement("div",{className:"music-element-container"},this.controls.map((function(t,a){return s.a.createElement("div",{key:a,className:"music-element",style:{flex:1,backgroundColor:t.color},onClick:function(){return e.setState({selected:t})}},t.name)}))),s.a.createElement("div",null,s.a.createElement(f.a,{onClick:function(){e.props.sendData(e.state.selections,e.prevPage,e.nextPage,e.state.numPages,e.state.pageNumber)},style:{position:"absolute",top:75,color:"maroon"}},"REHEARSE"),s.a.createElement(f.a,{onClick:this.prevPage},"Prev. page"),s.a.createElement(f.a,{onClick:this.nextPage},"Next page"))),s.a.createElement("div",{className:"bounds"},s.a.createElement(b.Document,{file:this.props.notes,onLoadSuccess:this.onDocumentLoadSuccess,className:"document-container"},s.a.createElement(b.Page,{pageNumber:this.state.pageNumber,className:"current-page",inputRef:function(t){return e.myPage=t}})),s.a.createElement("div",{id:"canvas",style:{width:.9*window.innerWidth,height:.9*window.innerWidth*1.3}},this.state.selections?this.state.selections[this.state.pageNumber]:"")))}}]),a}(s.a.Component),N=function(e){Object(m.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(l.a)(this,a);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(e=t.call.apply(t,[this].concat(s))).state={screen:"select",files:[],timestamps:[],bpm:null},e.rehearse=function(t,a,n,s,r){for(var c=e.state.timestamps,o=e.audio.duration,l={},i=0;i<s;i++)c[i]&&function(){var e=i+1;if(l[e]={start:c[i].time,duration:void 0===c[i+1]?o-c[i].time:c[i+1].time-c[i].time,groups:[]},t[i+1].length){var a=0,n=t[i+1].map((function(e,t){var n=e.props.style.left,s=e.props.style.top,r=parseInt(e.props.children.props.children);return a+=r,{x:n,y:s,nm:r,start:null}}));console.log("GROUPS:",n),l[e].nm=a,l[e].ml=l[e].duration/a;var s=l[e].start;n.forEach((function(t,a){s+=0===a?0:t.nm*l[e].ml,t.start=s})),l[e].groups=n}}();e.audio.currentTime=0;var m=Object.keys(l).map((function(e,t){var a=[];return a.push(l[e].start),l[e].groups.forEach((function(e){return a.push({x:e.x,y:e.y,start:e.start})})),a}));m=m.flat();var p=0,d=Object(u.a)(e);document.getElementById("audio").ontimeupdate=function(){var e=d.audio.currentTime;document.querySelectorAll(".rectangle").forEach((function(e){return e.children[0].style.color="transparent"})),m[p]&&(m[p].y?e>=m[p].start&&(window.scrollTo(parseInt(m[p].x),parseInt(m[p].y)),p++):e>=m[p]&&(0!==p&&n(),p++))},e.audio.play()},e}return Object(i.a)(a,[{key:"render",value:function(){var e=this;if("select"===this.state.screen)return s.a.createElement("div",{className:"App select"},s.a.createElement("h1",{className:"title"},"NoteLight"),s.a.createElement(d.a,{onDrop:function(t){e.setState({files:[].concat(Object(o.a)(e.state.files||[]),Object(o.a)(t))})}},(function(t){var a=t.getRootProps,n=t.getInputProps;return s.a.createElement("section",{className:"dropzone-container"},s.a.createElement("div",Object.assign({},a(),{className:"dropzone"}),s.a.createElement("input",n()),s.a.createElement("p",null,"Drag 'n' drop some files here, or click to select files")),s.a.createElement("aside",null,s.a.createElement("h3",null,"Files:"),s.a.createElement("ul",null,e.state.files.map((function(e){return s.a.createElement("li",{key:e.name},e.name)})))))})),s.a.createElement(f.a,{onClick:function(){return e.setState({screen:"editor"})},className:"continue-button".concat(this.state.files.length>=2?"":" disabled")},"Continue"));if("editor"===this.state.screen){var t=this.state.files.find((function(e){return"application/pdf"===e.type})),a=this.state.files.find((function(e){return"audio/mpeg"===e.type}));return s.a.createElement("div",{className:"App editor"},s.a.createElement("div",{className:"player-container"},s.a.createElement("audio",{ref:function(t){e.audio=t},className:"guide-mp3",id:"audio",src:URL.createObjectURL(a),controls:!0,type:"audio/mpeg"}),s.a.createElement(h.a,{placeholder:"Timestamp name...",ref:function(t){e.timename=t},style:{width:"15%"}}),s.a.createElement(f.a,{onClick:function(){e.setState({timestamps:[].concat(Object(o.a)(e.state.timestamps||[]),[{name:e.timename.state.value,time:e.audio.currentTime}])})}},"Add timestamp"),s.a.createElement(h.a,{placeholder:"bpm...",ref:function(t){e.bpm=t},style:{width:"15%",marginLeft:15}}),s.a.createElement(f.a,{onClick:function(){return e.setState({bpm:e.bpm.state.value})},style:{marginRight:15}},"Add bpm")," ",this.state.bpm?"Set to ".concat(this.state.bpm," bpm"):"",s.a.createElement("ul",{className:"timestamps"},this.state.timestamps.map((function(e,t){return s.a.createElement("li",{key:t},e.name," - ",e.time)})))),s.a.createElement(E,{notes:t,sendData:this.rehearse}))}return"playback"===this.state.screen?s.a.createElement("h1",null,"Playback"):""}}]),a}(s.a.Component);c.a.render(s.a.createElement(N,null),document.getElementById("root"))},47:function(e,t){function a(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}a.keys=function(){return[]},a.resolve=a,e.exports=a,a.id=47}},[[126,1,2]]]);
//# sourceMappingURL=main.6ca2346a.chunk.js.map